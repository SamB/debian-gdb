Status: unsubmitted

This patch was for Debian bug #239535.  It needs to be tested, and
submitted.  It has shrunk since the first version, and may no
longer be necessary.

---
 gdb/valops.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

Index: gdb-7.3.50~cvs20110627/gdb/valops.c
===================================================================
--- gdb-7.3.50~cvs20110627.orig/gdb/valops.c	2011-06-28 00:08:28.227103791 +0100
+++ gdb-7.3.50~cvs20110627/gdb/valops.c	2011-06-28 00:08:33.547103817 +0100
@@ -3153,8 +3153,10 @@
 	return 1;
     }
 
+  /* Check each baseclass.  Call check_typedef, which will follow typedefs
+     and do opaque/stub type resolution.  */
   for (i = TYPE_N_BASECLASSES (type) - 1; i >= 0; i--)
-    if (check_field (TYPE_BASECLASS (type, i), name))
+    if (check_field (check_typedef (TYPE_BASECLASS (type, i)), name))
       return 1;
 
   return 0;
